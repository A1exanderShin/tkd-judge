# TKD Judge — судейская система для соревнований

Backend-система судейства для поединков (Taekwondo ITF).
Реализует управление боем, подсчёт очков, предупреждения, таймер,
экспорт протокола (JSON/PDF) и минимальный UI для демо.

## Возможности (MVP)
- FSM боя: IDLE → RUNNING → PAUSED → FINISHED
- Управление боем: start / pause / resume / stop / reset
- Подсчёт очков судьями (+1 / +2 / +3)
- Антинаклик для судей
- Предупреждения с автрафом (N предупреждений → штраф)
- Таймер боя
- WebSocket API
- Экспорт протокола боя:
  - JSON: `/protocol`
  - PDF: `/protocol/pdf`
- Автосохранение PDF при завершении боя
- Минимальный UI для демонстрации

## Архитектура (кратко)
- **FSM (Fight)** — источник истины состояния боя
- **Hub (WS)** — event-loop, маршрутизация событий
- **Timer** — независимый таймер боя
- **Scoreboard / Warnings** — бизнес-логика подсчёта
- **Protocol** — сбор и экспорт протокола
- **UI** — тонкий клиент без бизнес-логики

## Структура проекта
```

cmd/server/                # Точка входа
internal/
config/                  # Конфигурация боя
events/                  # Доменные события
fight/                   # FSM, таймер, счёт, предупреждения
judges/                  # Судьи + антинаклик
ws/                      # WebSocket Hub и обработчики
protocol/                # JSON-протокол
pdf/                     # PDF-генерация
http/                    # HTTP handlers
ui/                         # Минимальный UI (HTML)

````

## Быстрый старт
```bash
go run ./cmd/server
````

Открой UI:

```
ui/index.html
```

## Демонстрация (рекомендуемый сценарий)

1. Start — бой начинается, таймер идёт
2. Судьи начисляют очки
3. Warning → автоштраф
4. Pause / Resume
5. Stop — бой завершается
6. Download PDF — скачивание протокола
7. Reset — новый бой

## Конфигурация

Файл: `internal/config/config.go`

Настраивается без изменения логики:

* длительность раунда
* антинаклик
* число судей
* правила штрафов

## Экспорт протокола

* JSON: `GET /protocol`
* PDF: `GET /protocol/pdf`
* PDF автоматически сохраняется при `FINISHED`

## Ограничения MVP

* История боёв не хранится (протокол одного боя)
* Нет ролей и авторизации
* UI предназначен для демо

## Возможные расширения

* Роли (главный судья / судья / табло)
* Хранение истории боёв
* Конфигурация из YAML/JSON
* Полноценный UI
* Интеграция с табло

## Статус

Проект завершён на уровне MVP и готов к демонстрации заказчику.
